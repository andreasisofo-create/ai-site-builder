<!-- Services Interactive Tabs: JS-powered tabbed interface with animated content crossfade, decorative backgrounds, and blur-slide transitions -->
<section id="services" class="py-24 md:py-32 bg-[var(--color-bg)] overflow-hidden relative">

  <!-- Ambient decorative elements -->
  <div class="absolute inset-0 pointer-events-none">
    <div class="absolute top-20 right-[10%] w-96 h-96 bg-[var(--color-primary)]/5 rounded-full blur-3xl"></div>
    <div class="absolute bottom-20 left-[5%] w-80 h-80 bg-[var(--color-secondary)]/5 rounded-full blur-3xl"></div>
    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] rounded-full opacity-[0.03]" style="background: radial-gradient(circle, var(--color-primary), transparent 70%);"></div>
  </div>

  <!-- Subtle grid background -->
  <div class="absolute inset-0 opacity-[0.02]" style="background-image: linear-gradient(var(--color-text) 1px, transparent 1px), linear-gradient(90deg, var(--color-text) 1px, transparent 1px); background-size: 60px 60px;"></div>

  <div class="max-w-7xl mx-auto px-6 relative z-10">
    <!-- Header -->
    <div class="text-center mb-16 md:mb-20" data-animate="reveal-up">
      <p class="text-sm font-semibold tracking-widest uppercase text-[var(--color-primary)] mb-4" data-animate="blur-in">I Nostri Servizi</p>
      <h2 class="text-3xl md:text-5xl lg:text-6xl font-bold font-heading text-[var(--color-text)] mb-5" data-animate="text-split" data-split-type="words">{{SERVICES_TITLE}}</h2>
      <p class="text-[var(--color-text-muted)] max-w-2xl mx-auto text-lg font-body" data-animate="blur-slide" data-delay="0.2" data-duration="1">{{SERVICES_SUBTITLE}}</p>
    </div>

    <!-- Tab Navigation -->
    <div class="relative mb-12" data-animate="fade-up" data-delay="0.3">
      <!-- Tab bar -->
      <div class="svc-itabs-nav flex flex-nowrap overflow-x-auto gap-2 md:gap-3 justify-start md:justify-center pb-4 scrollbar-hide" role="tablist">
        <!-- REPEAT:SERVICES -->
        <button
          type="button"
          role="tab"
          class="svc-itab-btn group relative flex items-center gap-2.5 px-5 py-3 md:px-6 md:py-3.5 rounded-xl font-heading text-sm md:text-base font-semibold whitespace-nowrap transition-all duration-400 border border-transparent text-[var(--color-text-muted)] hover:text-[var(--color-text)] hover:bg-[var(--color-bg-alt)]/60"
          data-tab-index="{{INDEX}}"
          aria-selected="false"
          onclick="switchServiceTab(this)"
        >
          <span class="text-xl md:text-2xl transition-transform duration-300 group-hover:scale-110">{{SERVICE_ICON}}</span>
          <span class="hidden sm:inline">{{SERVICE_TITLE}}</span>
        </button>
        <!-- /REPEAT:SERVICES -->
      </div>
      <!-- Active indicator line -->
      <div class="absolute bottom-0 left-0 right-0 h-px bg-[var(--color-text)]/8"></div>
    </div>

    <!-- Tab Panels Container -->
    <div class="svc-itabs-panels relative min-h-[300px] md:min-h-[350px]">
      <!-- REPEAT:SERVICES -->
      <div
        class="svc-itab-panel absolute inset-0 opacity-0 translate-y-4 pointer-events-none transition-all duration-500 ease-out"
        data-panel-index="{{INDEX}}"
        role="tabpanel"
      >
        <div class="flex flex-col lg:flex-row items-center gap-10 lg:gap-16">
          <!-- Left: Visual element -->
          <div class="flex-shrink-0 w-full lg:w-2/5">
            <div class="relative">
              <!-- Large icon container -->
              <div class="relative w-48 h-48 md:w-56 md:h-56 mx-auto rounded-3xl overflow-hidden" data-animate="blur-slide">
                <!-- Background gradient -->
                <div class="absolute inset-0 bg-gradient-to-br from-[var(--color-primary)]/15 via-[var(--color-secondary)]/10 to-[var(--color-accent)]/15"></div>
                <!-- Glass border -->
                <div class="absolute inset-0 rounded-3xl border border-[var(--color-primary)]/20"></div>
                <!-- Icon -->
                <div class="absolute inset-0 flex items-center justify-center">
                  <span class="text-7xl md:text-8xl drop-shadow-lg">{{SERVICE_ICON}}</span>
                </div>
              </div>
              <!-- Decorative ring -->
              <div class="absolute -inset-4 rounded-[2rem] border border-dashed border-[var(--color-primary)]/10 pointer-events-none"></div>
              <!-- Floating dots -->
              <div class="absolute -top-2 -right-2 w-4 h-4 rounded-full bg-[var(--color-primary)]/20" data-animate="float"></div>
              <div class="absolute -bottom-3 -left-3 w-3 h-3 rounded-full bg-[var(--color-secondary)]/20" data-animate="float"></div>
            </div>
          </div>

          <!-- Right: Content -->
          <div class="flex-1 text-center lg:text-left">
            <h3 class="text-2xl md:text-3xl lg:text-4xl font-bold font-heading text-[var(--color-text)] mb-5">
              {{SERVICE_TITLE}}
            </h3>
            <p class="text-[var(--color-text-muted)] text-base md:text-lg leading-relaxed font-body max-w-xl mx-auto lg:mx-0 mb-8">
              {{SERVICE_DESCRIPTION}}
            </p>
            <!-- Decorative accent bar -->
            <div class="flex items-center gap-3 justify-center lg:justify-start">
              <div class="h-1 w-12 rounded-full bg-gradient-to-r from-[var(--color-primary)] to-[var(--color-secondary)]"></div>
              <div class="h-1 w-4 rounded-full bg-[var(--color-primary)]/30"></div>
              <div class="h-1 w-2 rounded-full bg-[var(--color-primary)]/15"></div>
            </div>
          </div>
        </div>
      </div>
      <!-- /REPEAT:SERVICES -->
    </div>
  </div>

  <!-- Inline JS for tab switching -->
  <script>
    (function() {
      function initServiceTabs() {
        var btns = document.querySelectorAll('.svc-itab-btn');
        var panels = document.querySelectorAll('.svc-itab-panel');
        if (btns.length === 0) return;

        // Activate first tab
        activateTab(btns[0], panels, 0);
      }

      window.switchServiceTab = function(btn) {
        var idx = parseInt(btn.getAttribute('data-tab-index'));
        var panels = document.querySelectorAll('.svc-itab-panel');
        var btns = document.querySelectorAll('.svc-itab-btn');
        activateTab(btn, panels, idx);
      };

      function activateTab(btn, panels, idx) {
        var btns = document.querySelectorAll('.svc-itab-btn');

        // Deactivate all tabs
        btns.forEach(function(b) {
          b.classList.remove('svc-itab-active');
          b.setAttribute('aria-selected', 'false');
          b.style.background = '';
          b.style.borderColor = 'transparent';
          b.style.color = '';
        });

        // Activate clicked tab
        btn.classList.add('svc-itab-active');
        btn.setAttribute('aria-selected', 'true');
        btn.style.background = 'rgba(var(--color-primary-rgb), 0.08)';
        btn.style.borderColor = 'rgba(var(--color-primary-rgb), 0.2)';
        btn.style.color = 'var(--color-primary)';

        // Switch panels with crossfade
        panels.forEach(function(p, i) {
          if (parseInt(p.getAttribute('data-panel-index')) === idx) {
            p.style.opacity = '1';
            p.style.transform = 'translateY(0)';
            p.style.pointerEvents = 'auto';
          } else {
            p.style.opacity = '0';
            p.style.transform = 'translateY(1rem)';
            p.style.pointerEvents = 'none';
          }
        });
      }

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initServiceTabs);
      } else {
        initServiceTabs();
      }
    })();
  </script>

  <style>
    .svc-itabs-nav::-webkit-scrollbar { display: none; }
    .svc-itabs-nav { -ms-overflow-style: none; scrollbar-width: none; }
    .svc-itab-btn:focus-visible {
      outline: 2px solid var(--color-primary);
      outline-offset: 2px;
    }
  </style>
</section>
